services:
  api:
    image: ${API_IMAGE:-ghcr.io/gamedirection/open-tts-api:0.4.0}
    ports:
      - "${API_PORT:-3016}:5000"
    environment:
      - PIPER_VOICES_DIR=${PIPER_VOICES_DIR:-/data/voices}
      - PIPER_AUDIO_DIR=${PIPER_AUDIO_DIR:-/data/audio}
      - PIPER_DEFAULT_VOICE=${PIPER_DEFAULT_VOICE:-en_US-lessac-medium}
      - PIPER_DEFAULT_VOICE_BASE=${PIPER_DEFAULT_VOICE_BASE:-https://huggingface.co/rhasspy/piper-voices/resolve/v1.0.0/en/en_US/lessac/medium}
      - PIPER_TIMEOUT_SECONDS=${PIPER_TIMEOUT_SECONDS:-60}
    volumes:
      - piper_voices:/data/voices
      - piper_audio:/data/audio

  web:
    image: ${WEB_IMAGE:-ghcr.io/gamedirection/open-tts-web:0.4.0}
    ports:
      - "${WEB_PORT:-3015}:80"
    depends_on:
      - api

  swagger:
    image: swaggerapi/swagger-ui:latest
    ports:
      - "${SWAGGER_PORT:-3017}:8080"
    environment:
      - SWAGGER_JSON=/openapi.json
      - BASE_URL=/
    volumes:
      - ./backend/openapi.static.json:/openapi.json:ro
    depends_on:
      - api

volumes:
  piper_voices:
  piper_audio:
